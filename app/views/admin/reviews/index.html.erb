<div class="container mt-5">
  <div class="row">
    <div class="col">
      <%= link_to "作成日順", admin_reviews_path(create_latest: "作成日"), class: "btn btn-sm btn-warning" %>
      <%= link_to "更新日順", admin_reviews_path(update_latest: "更新日"), class: "btn btn-sm btn-primary" %>
      <h4 class="mt-4 mb-2 bg-secondary text-white">レビュー一覧</h4>
      <div class="review_info card">
        <% @reviews.each do |review| %>
          <div class="card mb-1">
            <div class="card-body">
              <button type="button" class="close" aria-label="Close">
                <%= link_to admin_review_path(review.id), method: :delete, data: {confirm: "本当に削除しますか?"} do %>
                  <span aria-hidden="true">&times;</span>
                <% end %>
              </button>
              <div class="container">
                <div class="row">
                  <div class="col-md-3 d-flex flex-column form-inline">
                    <%= link_to edit_admin_book_path(review.book.id) do %>
                      <%= image_tag review.book.item_image_url, size: "100x140", class:"mr-3" %>
                    <% end %>
                    <%= review.book.title%>
                  </div>
                  <div class="col-md-9">
                    <div class="row border-bottom">
                      <div class="col-md-2 ">
                        <%= link_to edit_admin_user_path(review.user.id) do %>
                          <%= image_tag review.user.get_profile_image(60,60), class:"rounded-circle"%>
                        <% end %>
                      </div>
                      <div class="col-md-2 mt-3">
                        <%= review.user.nickname %>
                      </div>
                      <div class="col-md-4 mt-3">
                        <p><%= l review.created_at %>&ensp;&ensp;&ensp;<%= review.favorites.count%>いいね</p>
                      </div>
                    </div>
                    <div class="row">
                      <%= review.comment%>
                    </div>
                  </div>
                </div>
              </div>
              <% review.comments.where.not(id: nil).each do |comment| %>
                <div class="card mb-1 ml-5">
                  <div class="card-body">
                    <button type="button" class="close" aria-label="Close">
                      <%= link_to admin_comment_path(comment), method: :delete, data: {confirm: "本当に削除しますか?"} do %>
                        <span aria-hidden="true">&times;</span>
                      <% end %>
                    </button>
                    <div class="container">
                      <div class="row">
                        <div class="col-md-2 d-flex flex-column form-inline">
                          <%= link_to edit_admin_user_path(comment.user.id) do %>
                            <%= image_tag comment.user.get_profile_image(60,60), class:"rounded-circle" %>
                          <% end %>
                        </div>
                        <div class="col-md-10">
                          <div class="row border-bottom">
                            <%= comment.user.nickname %>&ensp;&ensp;&ensp;<%= l comment.created_at%>
                          </div>
                          <div class="row">
                            <%= comment.comment %>
                          </div>
                        </div>
                      </div>
                    </div> 
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
